<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.24.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.24.0/firebase-firestore.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
    <script src="https://www.gstatic.com/firebasejs/7.24.0/firebase-analytics.js"></script>

    <script>
    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
     var firebaseConfig = {
    apiKey: "AIzaSyCYnp8j0BE0dbKzM4coTSzHn45BEQnetOU",
    authDomain: "melissa-fb2.firebaseapp.com",
    databaseURL: "https://melissa-fb2.firebaseio.com",
    projectId: "melissa-fb2",
    storageBucket: "melissa-fb2.appspot.com",
    messagingSenderId: "286187103397",
    appId: "1:286187103397:web:a9efc7f18bf014c084594c",
    measurementId: "G-3FKGWJD4HG"
    };
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    firebase.analytics();
    const DB=firebase.firestore();
    </script>

</head>
<body>
    <h1> Voting !!!!</h1>
    <form id="voteOptions">
        <p> What question are you voting on??</p>
        <input type="text" placeholder="Write question here" id="questionInput"/>
        <p> Option 1: <input id="option1" type="text" placeholder="Write answer here"/> </p>
        <p> Option 2: <input id="option1" type="text" placeholder="Write answer here"/> </p>
        <p> Option 3: <input id="option1" type="text" placeholder="Write answer here"/></p>
        <input type ="submit" value ="Start voting"/>
    </form>
    <h2 id="question"></h2>
    <script>
        const votingOptions=document.getElementById('voteOptions');
        let op1="";
        let op2="";
        let op3="";
        let question="";
        votingOptions.addEventListener('submit', e=>{
            e.preventDefault();
            question=document.getElementById('questionInput').value;
            op1=document.getElementById('option1').value;
            op2=document.getElementById('option2').value;
            op3=document.getElementById('option3').value;
            DB.collection('voting').doc('question').set({question:question});
            DB.collection('voting').doc('option1').set({option:op1, numVotes:0});
            DB.collection('voting').doc('option2').set({option:op2, numVotes:0});
            DB.collection('voting').doc('option3').set({option:op3, numVotes:0});
            votingOptions.style.display="none";

        })
      
        let quest="";
        DB.collection('voting').doc('question').onSnapshot(questionDB=>{
            quest=questionDB.data().question;
            document.getElementById('question').innerText=quest;
            document.getElementById('question').style.display="inline";
            document.getElementById('options').style.display="inline";


        } )



    </script>


<script>
    //create a unique id for the user, and store in the browser

    //create unique id:
    const uid = function () {
        return Date.now().toString(36) + Math.random().toString(36).substr(2);
    }
    //store in the local storage
   
    function getUserUID() {

        //get the uid
        let userUID = localStorage.getItem('userUID');

        if (userUID === null) {
            userUID = uid();
            //create a uid
            localStorage.setItem('userUID', userUID);

        }

        return userUID;

    }
</script>


</body>
</html>