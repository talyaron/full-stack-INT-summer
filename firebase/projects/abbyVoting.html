<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <!-- The core Firebase JS SDK is always required and must be listed first -->
    <script src="https://www.gstatic.com/firebasejs/7.24.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.24.0/firebase-firestore.js"></script>

    <!-- TODO: Add SDKs for Firebase products that you want to use
               https://firebase.google.com/docs/web/setup#available-libraries -->

    <script>
        // Your web app's Firebase configuration
        var firebaseConfig = {
            apiKey: "AIzaSyCuqXvrC20supCgCk2qdXMV5k0qwiNzCro",
            authDomain: "abbyfb1.firebaseapp.com",
            databaseURL: "https://abbyfb1.firebaseio.com",
            projectId: "abbyfb1",
            storageBucket: "abbyfb1.appspot.com",
            messagingSenderId: "868023743677",
            appId: "1:868023743677:web:cfb2d64ccb6ef557a133d4"
        };
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
    </script>
</head>
<style>
    .header {
        font-size: 25px;
    }

    #bidenName {
        color: cornflowerblue;
    }

    #trumpName {
        color: rgb(230, 60, 60);
    }

    #rootBiden {
        color: blue;
        font-size: 15px;
    }

    #rootTrump {
        color: rgb(104, 1, 1);
        font-size: 15px;
    }
</style>

<body>
    <!--inputs are user enter name, buttons Biden Trump, obstention-->
    <form onsubmit="handleSubmit(event)">
        <input type="text" placeholder="name or write anonymous" name="name">
        <input type="submit" value="Biden" name="bidenButton">
        <input type="submit" value="Trump" name="trumpButton">
    </form>
    <h id="trumpName" class="header">TRUMP</h1>
        <div id="rootTrump"></div>
        <h id="bidenName" class="header">BIDEN</h1>
            <div id="rootBiden"></div>
            <!--enters the name or anonymous and the vote into the database-->
            <!--if press biden then update biden to be true and trump to be false-->
            <script>
                const DB = firebase.firestore();
                let htmlBiden = '';
                let htmlTrump = '';

                const bidenButton = document.getElementsByName('bidenButton')[0];
                const trumpButton = document.getElementsByName('trumpButton')[0];
                let biden = false;
                let bidenName = "";

                let trump = false;
                let trumpName = "";

                bidenButton.addEventListener('click', e => {
                    e.preventDefault();

                    bidenName = document.getElementsByName('name')[0].value;
                    console.log(bidenName)

                    biden = true;
                    trump = false;
                    console.log("Biden: " + biden)

                    DB.collection('voting').add({ name: bidenName, biden: biden, trump: trump })
                        .then(() => { console.log('vote counted') })
                        .catch(err => { console.error(err) })

                    voteWriting ()
                })

                trumpButton.addEventListener('click', e => {
                    e.preventDefault();

                    trumpName = document.getElementsByName('name')[0].value;
                    console.log(trumpName)

                    trump = true;
                    biden = false;
                    console.log("Trump: " + trump)

                    DB.collection('voting').add({ name: trumpName, biden: biden, trump: trump })
                        .then(() => { console.log('vote counted') })
                        .catch(err => { console.error(err) })
                    voteWriting()
                })
                //updating who voted for who 
                function voteWriting() {
                    DB.collection('voting').onSnapshot(votingDB => {
                        htmlBiden = '';
                        htmlTrump = '';
                        votingDB.forEach(voteDB => {
                            console.log(voteDB.data())
                            console.log(`${voteDB.data().biden}`)
                            if (`${voteDB.data().biden}` == "true") {
                                const rootBiden = document.getElementById('rootBiden');
                                htmlBiden += `<div class="bidenVoters>${bidenName}</div>`;
                                console.log(htmlBiden)
                                rootBiden.innerHTML = htmlBiden;
                            } else {
                                const rootTrump = document.getElementById('rootTrump');
                                htmlTrump += `<div class="trumpVoters>${trumpName}</div>`;
                                console.log(htmlTrump)
                                rootTrump.innerHTML = htmlTrump;
                            }

                        });
                    })
                }

            </script>

            <!--onSnapshot it shows who voted for who -- put the name into a div above the president voted for, if biden true then put name there, if trump true then put there-->

</body>

</html>