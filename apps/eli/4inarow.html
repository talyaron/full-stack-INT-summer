<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/7.24.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.24.0/firebase-firestore.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/7.24.0/firebase-analytics.js"></script>

<script>
  // Your web app's Firebase configuration
  // For Firebase JS SDK v7.20.0 and later, measurementId is optional
  var firebaseConfig = {
    apiKey: "AIzaSyDljvPd9ZtBLSBHEl3AQiodZCFtt803AkA",
    authDomain: "eli-first.firebaseapp.com",
    databaseURL: "https://eli-first.firebaseio.com",
    projectId: "eli-first",
    storageBucket: "eli-first.appspot.com",
    messagingSenderId: "552298531905",
    appId: "1:552298531905:web:ce8c06216aedd704cd4ac0",
    measurementId: "G-VC5X05NE5E"
  };
  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  firebase.analytics();
</script>

<style>
    .box{
        width: 50px;
        height: 50px;
        /*background-color: white;*/
        border: 2px solid black;
    }

    .click{
        width: fit-content;
        height: fit-content;
        background-color: blue;
        border: 2px solid black;
    }

    .container{
        width: 100%;
        height: 100%;
        display: flex;
        /*grid-template-columns: 50px 50px 50px 50px 50px 50px 50px;
        grid-template-rows: 50px 50px 50px 50px 50px 50px;*/
        gap: 5px;

        position: relative;
        top: 100px;
        left: 25%;
    }
</style>

<body>
    <div>
        <span style="color: blue;">Player 1</span>
        <br/>
        <span style="color: red;">Player 2</span>
    </div>


    <div class="container">
        <div>
            <div class="column" id="one">
                <div class="box" id="box6" style="background-color: white;"></div><div class="box" id="box5" style="background-color: white;"></div>
                <div class="box" id="box4" style="background-color: white;"></div><div class="box" id="box3" style="background-color: white;"></div>
                <div class="box" id="box2" style="background-color: white;"></div><div class="box" id="box1" style="background-color: white;"></div>
                <div class="click" id="one"><button>row 1</button></div>
            </div>
        </div>
        <div>
            <div class="column" id="two">
                <div class="box" id="box6" style="background-color: white;"></div><div class="box" id="box5" style="background-color: white;"></div>
                <div class="box" id="box4" style="background-color: white;"></div><div class="box" id="box3" style="background-color: white;"></div>
                <div class="box" id="box2" style="background-color: white;"></div><div class="box" id="box1" style="background-color: white;"></div>
                <div class="click" id="two"><button>row 2</button></div>
            </div>
        </div>
        <diV>
            <div class="column" id="three">
                <div class="box" id="box6" style="background-color: white;"></div><div class="box" id="box5" style="background-color: white;"></div>
                <div class="box" id="box4" style="background-color: white;"></div><div class="box" id="box3" style="background-color: white;"></div>
                <div class="box" id="box2" style="background-color: white;"></div><div class="box" id="box1" style="background-color: white;"></div>
                <div class="click" id="three"><button>row 3</button></div>
            </div>
        </div>
        <div>
            <div class="column" id="four">
                <div class="box" id="box6" style="background-color: white;"></div><div class="box" id="box5" style="background-color: white;"></div>
                <div class="box" id="box4" style="background-color: white;"></div><div class="box" id="box3" style="background-color: white;"></div>
                <div class="box" id="box2" style="background-color: white;"></div><div class="box" id="box1" style="background-color: white;"></div>
                <div class="click" id="four"><button>row 4</button></div>
            </div>
        </div>
        <div>
            <div class="column" id="five">
                <div class="box" id="box6" style="background-color: white;"></div><div class="box" id="box5" style="background-color: white;"></div>
                <div class="box" id="box4" style="background-color: white;"></div><div class="box" id="box3" style="background-color: white;"></div>
                <div class="box" id="box2" style="background-color: white;"></div><div class="box" id="box1" style="background-color: white;"></div>
                <div class="click" id="five"><button>row 5</button></div>
            </div>
        </div>
        <div>
            <div class="column" id="six">
                <div class="box" id="box6" style="background-color: white;"></div><div class="box" id="box5" style="background-color: white;"></div>
                <div class="box" id="box4" style="background-color: white;"></div><div class="box" id="box3" style="background-color: white;"></div>
                <div class="box" id="box2" style="background-color: white;"></div><div class="box" id="box1" style="background-color: white;"></div>
                <div class="click" id="six"><button>row 6</button></div>
            </div>
        </div>
        <div>
            <div class="column" id="seven">
                <div class="box" id="box6" style="background-color: white;"></div><div class="box" id="box5" style="background-color: white;"></div>
                <div class="box" id="box4" style="background-color: white;"></div><div class="box" id="box3" style="background-color: white;"></div>
                <div class="box" id="box2" style="background-color: white;"></div><div class="box" id="box1" style="background-color: white;"></div>
                <div class="click" id="seven"><button>row 7</button></div>
            </div>
        </div>
        

    </div>


    <script>
        const DB = firebase.firestore();
        
        DB.collection("4inarow").doc("mMVx4S3gs05WyOZeT6x4").onSnapshot(trollDB=>{
            console.log('lsdjgdklgjlkdfjkdfdj')

            playerName = trollDB.data().name;
            playerColour = trollDB.data().colour;

            console.log(playerName, playerColour);


            choose()
            
        })


        

        let choose = function() {
            let buttons = document.querySelectorAll(".click");
            let columns = document.querySelectorAll(".column");
            
            buttons.forEach(element => {
                let columnNumber = element.id;
                console.log(columnNumber);

                element.addEventListener("click", e=>{


                    for(i=0; i<columns.length; i++){

                        if(columns[i].id === columnNumber){
                            console.log(columns[i]);
                            console.log(columnNumber);
                            

                            let name = "#"+columnNumber+">.box";
                            console.log(name);

                            const boxes = document.querySelectorAll(name);
                            console.log(boxes);

                            var boxesReverse = [];

                            for(j = boxes.length - 1; j >= 0; j--){
                                boxesReverse.push(boxes[j]);
                                console.log(j);
                                console.log("vvu");
                            }
                            console.log(boxesReverse);

                            var completed = false;
                            
                            boxesReverse.forEach(element =>{
                                console.log(element);
                                console.log(completed);
                                                                    
                                if(element.style.backgroundColor == "white" && completed == false){
                                    element.style.backgroundColor = playerColour;
                                    console.log(element.style.backgroundColor);
                                    completed = true;
                                } else{
                                    console.log(element.style.backgroundColor)
                                }
                                
                            })
                            
                           
                        } else{
                            console.log("different column");
                        }
                    }
                    playerChange()
                })
            })

        }

        let playerChange = function(){
            if(playerName == "player1"){
                DB.collection("4inarow").doc("mMVx4S3gs05WyOZeT6x4").update({name: "player2", colour: "red"})
            }else{
                DB.collection("4inarow").doc("mMVx4S3gs05WyOZeT6x4").update({name: "player1", colour: "blue"})
            }
            console.log("bhvkbvkvkdvksv svb jervre")
        }


        

    </script>

</body>
</html>